var MicroEvent=function(){};MicroEvent.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},MicroEvent.mixin=function(t){for(var e=["bind","unbind","trigger"],n=0;n<e.length;n++)"function"==typeof t?t.prototype[e[n]]=MicroEvent.prototype[e[n]]:t[e[n]]=MicroEvent.prototype[e[n]]};var Dispatcher=new MicroEvent;MicroEvent.mixin(Dispatcher);
var Dispatcher=function(){_RegisteredList=[]};Dispatcher.prototype.Register=function(e){_RegisteredList.push(e)},Dispatcher.prototype.Dispatch=function(e){console.log("prototype Dispatch",e);for(var t=0;t<_RegisteredList.length;t++)_RegisteredList[t].call(_RegisteredList[t],e)};var MyDispatcher=new Dispatcher;
var Constants={INCREMENT:"INCREMENT"};
var Actions={increment:function(){console.log("Actions increment"),MyDispatcher.Dispatch({actionType:Constants.INCREMENT})}};
var Store={i:0,increment:function(){console.log("Store increment"),this.i++},getCount:function(){return this.i}};MicroEvent.mixin(Store),MyDispatcher.Register(function(e){switch(e.actionType){case Constants.INCREMENT:console.log("Dispatcher Register",e),Store.increment(),Store.trigger("change",function(){console.log("change triggered")})}});
var Counter=React.createClass({displayName:"Counter",getInitialState:function(){return{count:0}},componentDidMount:function(){var t=this;console.log("componentDidMount"),Store.bind("change",function(){console.log("MicroEvent bind"),t.updateCount()})},componentWillMount:function(){Store.unbind("change")},updateCount:function(){this.setState({count:Store.getCount()})},render:function(){return React.createElement("div",null,React.createElement("div",null,this.state.count),React.createElement("button",{onClick:Actions.increment},"INCR"))}});React.render(React.createElement(Counter,null),document.body);